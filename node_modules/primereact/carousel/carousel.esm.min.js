import*as e from"react";import t,{PrimeReactContext as r,ariaLabel as n}from"primereact/api";import{usePrevious as a,useResizeListener as o,useMountEffect as l,useUpdateEffect as u,useUnmountEffect as c}from"primereact/hooks";import{ChevronDownIcon as i}from"primereact/icons/chevrondown";import{ChevronLeftIcon as s}from"primereact/icons/chevronleft";import{ChevronRightIcon as m}from"primereact/icons/chevronright";import{ChevronUpIcon as p}from"primereact/icons/chevronup";import{Ripple as f}from"primereact/ripple";import{classNames as v,mergeProps as d,UniqueComponentId as y,DomHandler as b,ObjectUtils as h,IconUtils as g}from"primereact/utils";import{ComponentBase as S}from"primereact/componentbase";function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function E(e,t){if("object"!==N(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function I(e){var t=E(e,"string");return"symbol"===N(t)?t:String(t)}function O(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e){if(Array.isArray(e))return w(e)}function P(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function j(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function x(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){if(Array.isArray(e))return e}function T(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,l,u=[],c=!0,i=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(i)throw a}}return u}}function A(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){return k(e)||T(e,t)||j(e,t)||A()}var V=S.extend({defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0}});function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=e.memo((function(t){var r=t.template(t.item),n=v(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end}),a=t.ptm(t.className&&"p-carousel-item-cloned"===t.className?"itemCloned":"item"),o=d({className:n},a);return e.createElement("div",o,r)})),H=e.memo(e.forwardRef((function(S,N){var E=e.useContext(r),I=V.getProps(S,E),O=R(e.useState(I.numVisible),2),w=O[0],k=O[1],T=R(e.useState(I.numScroll),2),A=T[0],M=T[1],H=R(e.useState(I.page*I.numScroll*-1),2),L=H[0],X=H[1],_=R(e.useState(I.page),2),Y=_[0],z=_[1],J=V.setMetaData({props:I,state:{numVisible:w,numScroll:A,totalShiftedItems:L,page:Y}}).ptm,F=e.useRef(null),U=e.useRef(null),W=e.useRef(0),$=e.useRef(!!I.autoplayInterval),q=e.useRef(""),G=e.useRef(20),K=e.useRef(null),Q=e.useRef(null),Z=e.useRef(null),ee=e.useRef(!1),te=e.useRef(null),re=a(A),ne=a(w),ae=a(I.value),oe=a(I.page),le="vertical"===I.orientation,ue=I.circular||!!I.autoplayInterval,ce=ue&&I.value&&I.value.length>=w,ie=I.value?Math.max(Math.ceil((I.value.length-w)/A)+1,0):0,se=ie&&I.autoplayInterval&&$.current,me=I.onPageChange&&!se,pe=me?I.page:Y,fe=R(o({listener:function(){de()},when:I.responsiveOptions}),1)[0],ve=function(e,t){var r=L;null!=t?(r=A*t*-1,ce&&(r-=w),ee.current=!1):(r+=A*e,ee.current&&(r+=W.current-A*e,ee.current=!1),t=Math.abs(Math.floor((ce?r+w:r)/A)));ce&&Y===ie-1&&-1===e?(r=-1*(I.value.length+w),t=0):ce&&0===Y&&1===e?(r=0,t=ie-1):t===ie-1&&W.current>0&&(r+=-1*W.current-A*e,ee.current=!0),U.current&&(b.removeClass(U.current,"p-items-hidden"),Pe(r),U.current.style.transition="transform 500ms ease 0s"),je(t),X(r)},de=function(){if(U.current&&te.current){for(var e=window.innerWidth,t={numVisible:I.numVisible,numScroll:I.numScroll},r=0;r<te.current.length;r++){var n=te.current[r];parseInt(n.breakpoint,10)>=e&&(t=n)}if(A!==t.numScroll){var a=Math.floor(pe*A/t.numScroll),o=t.numScroll*a*-1;ce&&(o-=t.numVisible),X(o),M(t.numScroll),je(a)}w!==t.numVisible&&k(t.numVisible)}},ye=function(e,t){(ue||0!==pe)&&ve(1,t),$.current=!1,e.cancelable&&e.preventDefault()},be=function(e,t){(ue||pe<ie-1)&&ve(-1,t),$.current=!1,e.cancelable&&e.preventDefault()},he=function(e,t){t>pe?be(e,t):t<pe&&ye(e,t)},ge=function(e){U.current&&"transform"===e.propertyName&&(b.addClass(U.current,"p-items-hidden"),U.current.style.transition="",0!==Y&&Y!==ie-1||!ce||Pe(L))},Se=function(e){var t=e.changedTouches[0];K.current={x:t.pageX,y:t.pageY}},Ne=function(e){e.cancelable&&e.preventDefault()},Ee=function(e){var t=e.changedTouches[0];Ie(e,le?t.pageY-K.current.y:t.pageX-K.current.x)},Ie=function(e,t){Math.abs(t)>G&&(t<0?be(e):ye(e))},Oe=function(){I.autoplayInterval>0&&(Q.current=setInterval((function(){ve(-1,Y===ie-1?0:Y+1)}),I.autoplayInterval))},we=function(){Q.current&&clearInterval(Q.current)},Ce=function(){Z.current||(Z.current=b.createInlineStyle(E&&E.nonce||t.nonce));var e,r="\n            .p-carousel[".concat(q.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/w,"%\n            }\n        ");if(I.responsiveOptions){te.current=C(e=I.responsiveOptions)||P(e)||j(e)||x(),te.current.sort((function(e,r){return h.sort(e.breakpoint,r.breakpoint,-1,E&&E.locale||t.locale,E&&E.nullSortOrder||t.nullSortOrder)}));for(var n=0;n<te.current.length;n++){var a=te.current[n];r+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat(q.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}Z.current.innerHTML=r},Pe=function(e){U.current&&(U.current.style.transform=le?"translate3d(0, ".concat(e*(100/w),"%, 0)"):"translate3d(".concat(e*(100/w),"%, 0, 0)"))},je=function(e){!me&&z(e),I.onPageChange&&I.onPageChange({page:e})};e.useImperativeHandle(N,(function(){return{props:I,startAutoplay:Oe,stopAutoplay:we,getElement:function(){return F.current}}})),l((function(){F.current&&(q.current=y(),F.current.setAttribute(q.current,"")),Ce(),de(),Pe(L),fe()})),u((function(){var e=!1,t=L;if(I.autoplayInterval&&we(),re!==A||ne!==w||I.value&&ae&&ae.length!==I.value.length){W.current=(I.value.length-w)%A;var r=pe;0!==ie&&r>=ie&&(je(r=ie-1),e=!0),t=r*A*-1,ce&&(t-=w),r===ie-1&&W.current>0?(t+=-1*W.current+A,ee.current=!0):ee.current=!1,t!==L&&(X(t),e=!0),Pe(t)}ce&&(0===Y?t=-1*w:0===t&&(t=-1*I.value.length,W.current>0&&(ee.current=!0)),t!==L&&(X(t),e=!0)),oe!==I.page&&(I.page>oe&&I.page<=ie-1?ve(-1,I.page):I.page<oe&&ve(1,I.page)),!e&&se&&Oe()})),c((function(){I.autoplayInterval&&we(),Z.current=b.removeInlineStyle(Z.current)}));var xe=function(){if(I.value&&I.value.length){var t=null,r=null;if(ce){var n=null;t=(n=I.value.slice(-1*w)).map((function(t,r){return e.createElement(B,{key:r+"_scloned",className:"p-carousel-item-cloned",template:I.itemTemplate,item:t,active:-1*L===I.value.length+w,start:0===r,end:r===n.length-1,ptm:J})})),r=(n=I.value.slice(0,w)).map((function(t,r){return e.createElement(B,{key:r+"_fcloned",className:"p-carousel-item-cloned",template:I.itemTemplate,item:t,active:0===L,start:0===r,end:r===n.length-1,ptm:J})}))}var a=I.value.map((function(t,r){var n=ce?-1*(L+w):-1*L,a=n+w-1;return e.createElement(B,{key:r,template:I.itemTemplate,item:t,active:n<=r&&a>=r,start:n===r,end:a===r,ptm:J})}));return e.createElement(e.Fragment,null,t,a,r)}},ke=function(){if(I.showNavigators){var t=(!ue||I.value&&I.value.length<w)&&0===pe,r=v("p-carousel-prev p-link",{"p-disabled":t}),a=d({className:"p-carousel-prev-icon"},J("previousButtonIcon")),o=g.getJSXIcon(le?I.prevIcon||e.createElement(p,a):I.prevIcon||e.createElement(s,a),D({},a),{props:I}),l=d({type:"button",className:r,onClick:function(e){return ye(e)},disabled:t,"aria-label":n("previousPageLabel")},J("previousButton"));return e.createElement("button",l,o,e.createElement(f,null))}return null},Te=function(){if(I.showNavigators){var t=(!ue||I.value&&I.value.length<w)&&(pe===ie-1||0===ie),r=v("p-carousel-next p-link",{"p-disabled":t}),a=d({className:"p-carousel-next-icon"},J("nextButtonIcon")),o=g.getJSXIcon(le?I.nextIcon||e.createElement(i,a):I.nextIcon||e.createElement(m,a),D({},a),{props:I}),l=d({type:"button",className:r,onClick:function(e){return be(e)},disabled:t,"aria-label":n("nextPageLabel")},J("nextButton"));return e.createElement("button",l,o,e.createElement(f,null))}return null},Ae=function(t){var r="carousel-indicator-"+t,a=v("p-carousel-indicator",{"p-highlight":pe===t}),o=d({key:r,className:a},J("indicator")),l=d({type:"button",className:"p-link",onClick:function(e){return he(e,t)},"aria-label":"".concat(n("pageLabel")," ").concat(t+1)},J("indicatorButton"));return e.createElement("li",o,e.createElement("button",l,e.createElement(f,null)))},Re=v("p-carousel p-component",{"p-carousel-vertical":le,"p-carousel-horizontal":!le},I.className),Ve=v("p-carousel-content",I.contentClassName),Me=function(){var t=xe(),r=le?I.verticalViewPortHeight:"auto",n=ke(),a=Te(),o=v("p-carousel-container",I.containerClassName),l=d({className:"p-carousel-items-content",style:{height:r},onTouchStart:function(e){return Se(e)},onTouchMove:function(e){return Ne(e)},onTouchEnd:function(e){return Ee(e)}},J("itemsContent")),u=d({className:o},J("container")),c=d({ref:U,className:"p-carousel-items-container",onTransitionEnd:ge},J("itemsContainer"));return e.createElement("div",u,n,e.createElement("div",l,e.createElement("div",c,t)),a)}(),De=function(){if(I.showIndicators){for(var t=v("p-carousel-indicators p-reset",I.indicatorsContentClassName),r=[],n=0;n<ie;n++)r.push(Ae(n));var a=d({className:t},J("indicators"));return e.createElement("ul",a,r)}return null}(),Be=function(){if(I.header){var t=d({className:"p-carousel-header"},J("header"));return e.createElement("div",t,I.header)}return null}(),He=function(){if(I.footer){var t=d({className:"p-carousel-footer"},J("footer"));return e.createElement("div",t,I.footer)}return null}(),Le=d({id:I.id,ref:F,className:Re,style:I.style},V.getOtherProps(I),J("root")),Xe=d({className:Ve},J("content"));return e.createElement("div",Le,Be,e.createElement("div",Xe,Me,De),He)})));B.displayName="CarouselItem",H.displayName="Carousel";export{H as Carousel};
